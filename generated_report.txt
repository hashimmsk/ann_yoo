Method & Logic
----------------

  - Multi-task neural network: shared dense trunk with dropout/batch norm feeding two heads - linear
    mPFS regressor and temperature-scaled sigmoid PFS6 classifier - trained jointly with Adam, equal
    loss weighting, and task-specific metrics for clinical interpretability.
  - Data pipeline: starts from trial-level CSV, drops metadata columns, performs a stratified 80/20
    split on binary PFS6, fits a StandardScaler on the train fold only, and uses callbacks
    (EarlyStopping, ReduceLROnPlateau, ModelCheckpoint) to limit overfitting while preserving the best
    weights.
  - Program logic: FastAPI backend loads the latest v7a artifacts, applies calibrated inference
    (age/performance/resection heuristics) when returning PFS6 percentages, exposes raw probabilities
    for transparency, and falls back to older models or heuristic estimates if neural predictions fail.

Results
----------------
Models were benchmarked on a held-out validation fold after training on the remaining data. The
table summarizes regression error (mPFS) and classification performance (PFS6) for the multi-task
ANN compared with classical baselines.

Validation RMSE / MAE / Classification Metrics
+----------------------------+--------+--------+----------+----------+
| Model                      |   RMSE |    MAE |      AUC |      ACC |
+============================+========+========+==========+==========+
| AJDANN v7a (multitask ANN) | 1.3446 | 1.1391 |   1.0000 |   1.0000 |
+----------------------------+--------+--------+----------+----------+
| Linear Regression          | 1.0242 | 0.7723 | nan      | nan      |
+----------------------------+--------+--------+----------+----------+
| Ridge Regression (alpha=1) | 1.0910 | 1.0837 | nan      | nan      |
+----------------------------+--------+--------+----------+----------+
| Random Forest Regressor    | 1.1015 | 1.0555 | nan      | nan      |
+----------------------------+--------+--------+----------+----------+

Validation
----------------
An 80/20 stratified split on PFS6 produced three holdout trials for sanity checking. The table
reports actual mPFS alongside predictions from each model; ANN probabilities are calibrated in the
FastAPI layer before being shown to clinicians.

Holdout Predictions (mPFS, months)
+----------+---------------+--------------+-----------------+---------------------+
| Trial    |   Actual mPFS |   AJDANN v7a |   Random Forest |   Linear Regression |
+==========+===============+==============+=================+=====================+
| Sample 1 |        1.9000 |       2.4386 |          3.3662 |              2.0690 |
+----------+---------------+--------------+-----------------+---------------------+
| Sample 2 |        4.2000 |       3.4642 |          5.1996 |              4.6369 |
+----------+---------------+--------------+-----------------+---------------------+
| Sample 3 |        7.3000 |       5.1570 |          6.5994 |              9.0109 |
+----------+---------------+--------------+-----------------+---------------------+
